<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Official Website — SN DESIGN STUDIO</title>

<link rel="stylesheet" href="assets/css/master.css">

</head>

<body class="create-page">

<div id="nav"></div>

<section class="hero-master">

<h1 id="engineTitle">AI ENGINE</h1>
<img id="heroImage" style="max-width:600px">

</section>

<section class="create-area">

<input type="file" id="videoInput" accept="video/*">
<video id="videoPreview" controls></video>

<input type="file" id="imageInput" accept="image/*">
<img id="imagePreview">

<button id="createBtn">CREATE VIDEO</button>

<div id="progress"></div>

</section>

<footer>
© SN Design Studio, 2026 · All rights reserved.
</footer>

<script src="assets/js/nav.js"></script>

<script>

/* ======================================
SN DESIGN CREATE ENGINE — ULTRA FINAL
====================================== */

document.addEventListener("DOMContentLoaded",()=>{

console.log("CREATE PAGE READY");

/* TEMPLATE LOAD */

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

const hero = document.getElementById("heroImage");
const title = document.getElementById("engineTitle");

if(template && hero && title){

   title.innerText = template.replaceAll("-"," ").toUpperCase();
   hero.src = `assets/images/template-${template}.jpg`;

}

/* PREVIEW SYSTEM */

let videoFile=null;
let imageFile=null;

const videoInput=document.getElementById("videoInput");
const imageInput=document.getElementById("imageInput");
const videoPreview=document.getElementById("videoPreview");
const imagePreview=document.getElementById("imagePreview");

if(videoInput){
videoInput.addEventListener("change",(e)=>{
videoFile=e.target.files[0];
if(videoFile){
videoPreview.src=URL.createObjectURL(videoFile);
}
});
}

if(imageInput){
imageInput.addEventListener("change",(e)=>{
imageFile=e.target.files[0];
if(imageFile){
imagePreview.src=URL.createObjectURL(imageFile);
}
});
}

/* ======================================
ULTRA RENDER + STATUS ENGINE
====================================== */

let jobID=null;
const progressDiv=document.getElementById("progress");

const btn=document.getElementById("createBtn");

if(btn){

btn.addEventListener("click",async()=>{

progressDiv.innerText="Starting render...";

try{

const res=await fetch("https://sn-design-api.onrender.com/api/render",{

method:"POST",
headers:{
"Content-Type":"application/json"
},
body:JSON.stringify({
mode:"direct"
})

});

if(!res.ok) throw new Error("render failed");

const data=await res.json();

jobID=data.jobID;

progressDiv.innerText="Render started";

pollStatus();

}catch(err){

console.error(err);
progressDiv.innerText="Render error";

}

});

}

/* STATUS POLLING */

async function pollStatus(){

if(!jobID) return;

const interval=setInterval(async()=>{

try{

const res=await fetch("https://sn-design-api.onrender.com/api/status?id="+jobID);
const data=await res.json();

progressDiv.innerText="STATUS: "+data.status+" ("+data.progress+"%)";

if(data.status==="complete"){
clearInterval(interval);
}

}catch(e){

progressDiv.innerText="Status error";

}

},1500);

}

});

</script>

</body>
</html>
