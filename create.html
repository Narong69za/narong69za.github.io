<!DOCTYPE html>
<html lang="th">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>SN DESIGN CREATE</title>

<style>

body{
 background:#0b0b0b;
 color:white;
 font-family:Arial;
 margin:0;
}

.container{
 padding:20px;
}

button{
 background:#ff0033;
 color:white;
 border:none;
 padding:12px 20px;
 cursor:pointer;
}

img{
 max-width:100%;
}

</style>

</head>
<body>

<div class="container">

<h2 id="templateTitle">Loading Template...</h2>

<img id="previewImage" />

<br><br>

<input id="promptInput" placeholder="Enter Prompt" style="width:100%;padding:10px;">

<br><br>

<button id="createBtn">CREATE</button>

<p id="statusText"></p>

</div>

<script>

/* ===============================
ULTRA SAFE CONFIG
=============================== */

const API_URL = "https://api.sn-designstudio.dev";

/* ===============================
INIT
=============================== */

document.addEventListener("DOMContentLoaded", ()=>{

 console.log("CREATE READY");

 const params = new URLSearchParams(window.location.search);

 let template = params.get("template");

 if(!template){

   console.warn("NO TEMPLATE PARAM â†’ using default");

   template = "dance-motion";

 }

 loadTemplate(template);

 document.getElementById("createBtn")
   .addEventListener("click", ()=>startRender(template));

});


/* ===============================
LOAD TEMPLATE UI
=============================== */

function loadTemplate(template){

 const title = document.getElementById("templateTitle");
 const img = document.getElementById("previewImage");

 title.innerText = "Template : " + template;

 img.src = "/assets/images/template-"+template+".jpg";

 img.onerror = ()=>{

  console.warn("preview image missing");

  img.style.display="none";

 };

}


/* ===============================
RENDER ENGINE
=============================== */

async function startRender(template){

 console.log("CTA CLICKED");

 const prompt = document.getElementById("promptInput").value;

 if(!prompt){

   alert("Enter prompt");

   return;

 }

 document.getElementById("statusText").innerText="Starting...";

 try{

   const res = await fetch(API_URL+"/api/render",{

     method:"POST",

     headers:{ "Content-Type":"application/json" },

     body:JSON.stringify({

       templateID:template,
       prompt:prompt

     })

   });

   const data = await res.json();

   console.log("JOB CREATED:",data);

   if(!data.success){

     throw new Error("ENGINE FAIL");

   }

   document.getElementById("statusText").innerText="JOB STARTED";

 }catch(err){

   console.error(err);

   document.getElementById("statusText").innerText="ERROR START ENGINE";

 }

}

</script>

</body>
</html>
