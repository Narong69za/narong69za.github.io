<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<title>Create | SN Design Studio</title>

<link rel="stylesheet" href="assets/css/master.css">

<style>

body{
background:#000;
color:#fff;
font-family:sans-serif;
padding:20px;
}

button{
background:#ff0033;
color:#fff;
border:none;
padding:15px 20px;
margin-top:10px;
}

#preview video{
width:100%;
margin-top:20px;
}

</style>

</head>
<body>

<h1>ULTRA GOD CREATE</h1>

<input id="prompt" placeholder="Enter prompt">
<br>
<button id="createBtn">CREATE VIDEO</button>

<h3 id="status">STATUS: IDLE</h3>

<pre id="debug"></pre>

<div id="preview"></div>

<script>

/* ================= CONFIG ================= */

const API = "https://api.sn-designstudio.dev";

/* ================= DEBUG ================= */

function log(msg){
document.getElementById("debug").textContent += msg+"\n";
}

/* ================= GET TEMPLATE ================= */

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

log("DOM LOADED");
log("Template: "+template);

if(!template){

document.getElementById("status").textContent =
"STATUS: NO TEMPLATE";

throw new Error("Template missing");

}

/* ================= TEMPLATE â†’ MODEL MAP ================= */

const MODEL_MAP = {

"dark-viral":"dark-viral",
"ai-lipsync":"ai-lipsync",
"dance-motion":"dance-motion",
"face-swap":"face-swap"

};

const model = MODEL_MAP[template];

if(!model){

document.getElementById("status").textContent =
"STATUS: MODEL NOT FOUND";

throw new Error("Model not mapped");

}

/* ================= CREATE BUTTON ================= */

document.getElementById("createBtn")
.addEventListener("click", async ()=>{

log("CTA CLICKED");

const prompt =
document.getElementById("prompt").value;

document.getElementById("status")
.textContent="STATUS: SENDING...";

try{

const res = await fetch(API+"/api/render",{

method:"POST",
headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({

model:model,
input:{
prompt:prompt
}

})

});

const data = await res.json();

log("Response: "+JSON.stringify(data));

if(!data.jobID){

throw new Error("No jobID");

}

document.getElementById("status")
.textContent="STATUS: PROCESSING";

startPolling(data.jobID);

}catch(e){

log("ERROR:"+e.message);

document.getElementById("status")
.textContent="STATUS: ERROR";

}

});

/* ================= STATUS POLLING ================= */

function startPolling(jobID){

log("Polling start: "+jobID);

const interval = setInterval(async()=>{

const res = await fetch(
API+"/api/status/"+jobID
);

const data = await res.json();

log("Progress:"+data.progress);

if(data.status==="complete"){

clearInterval(interval);

document.getElementById("status")
.textContent="STATUS: COMPLETE";

showPreview(data);

}

if(data.status==="error"){

clearInterval(interval);

document.getElementById("status")
.textContent="STATUS: ERROR";

}

},3000);

}

/* ================= PREVIEW ================= */

function showPreview(data){

if(!data.url) return;

document.getElementById("preview").innerHTML =

'<video controls autoplay src="'+data.url+'"></video>';

}

</script>

</body>
</html>
