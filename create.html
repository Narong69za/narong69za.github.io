<!DOCTYPE html>
<html lang="en">
<head>

<title>Official Website — SN DESIGN STUDIO</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link rel="stylesheet" href="assets/css/master.css">

</head>

<body class="create-page">

<div id="nav"></div>

<section class="hero-master">

<h1 id="engineTitle">AI ENGINE</h1>
<img id="heroImage" style="max-width:600px">

</section>


<section class="create-area">

<input type="file" id="videoInput" accept="video/*">
<video id="videoPreview" controls></video>

<input type="file" id="imageInput" accept="image/*">
<img id="imagePreview">

<button id="createBtn">CREATE VIDEO</button>

</section>


<footer>
© SN Design Studio, 2026 · All rights reserved.
</footer>

<script src="assets/js/nav.js"></script>

<script>

// TEMPLATE LOAD

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

const hero = document.getElementById("heroImage");
const title = document.getElementById("engineTitle");

if(template && hero && title){

   title.innerText = template.replaceAll("-"," ").toUpperCase();
   hero.src = `assets/images/template-${template}.jpg`;

}


// ==============================
// SN DESIGN ADD ONLY : TEMPLATE SAFETY CHECK
// ==============================

if(!template){
   console.warn("SN DESIGN TEMPLATE MISSING");
}


// PREVIEW

let videoFile=null;
let imageFile=null;

document.getElementById("videoInput").addEventListener("change",(e)=>{

   videoFile=e.target.files[0];

   if(videoFile){
      document.getElementById("videoPreview").src=
      URL.createObjectURL(videoFile);
   }

});

document.getElementById("imageInput").addEventListener("change",(e)=>{

   imageFile=e.target.files[0];

   if(imageFile){
      document.getElementById("imagePreview").src=
      URL.createObjectURL(imageFile);
   }

});


// ==============================
// SN DESIGN ADD ONLY : AUTO RESULT CHECK
// ==============================

async function autoCheck(jobId){

   console.log("AUTO CHECK START:",jobId);

   const timer = setInterval(async ()=>{

      try{

         const res = await fetch(`https://api.sn-designstudio.dev/api/result/${jobId}`);

         const data = await res.json();

         console.log("STATUS:",data);

         if(data && data.ready){

            clearInterval(timer);

            alert("Render completed");

            console.log("FINAL OUTPUT:",data.output);

         }

      }catch(e){

         console.log("CHECK ERROR:",e);

      }

   },5000);

}


// REAL RENDER ENGINE

document.getElementById("createBtn").addEventListener("click", async ()=>{

   console.log("BUTTON CLICKED");

   const inputData={

      video: videoFile ? videoFile.name : null,
      image: imageFile ? imageFile.name : null

   };

   try{

      const res = await fetch("https://api.sn-designstudio.dev/api/render",{

         method:"POST",
         headers:{ "Content-Type":"application/json" },
         body:JSON.stringify({
            template:template,
            input:inputData
         })

      });

      const data = await res.json();

      console.log("RENDER RESULT:",data);

      // ==============================
      // SN DESIGN ADD ONLY : AUTO PIPELINE START
      // ==============================

      if(data.jobId){

         autoCheck(data.jobId);

      }

      alert("Render job sent");

   }catch(e){

      console.log("ERROR:",e);

   }

});

</script>
<script>

// ======================================================
// SN DESIGN AUTO RENDER ENGINE
// ======================================================

async function startRender(model,input){

   const res = await fetch("/api/render-auto",{
      method:"POST",
      headers:{ "Content-Type":"application/json"},
      body:JSON.stringify({model,input})
   });

   const data = await res.json();

   if(!data.jobId) return;

   watchJob(data.jobId);

}

async function watchJob(id){

   const timer = setInterval(async()=>{

      const res = await fetch("/api/job/"+id);
      const job = await res.json();

      console.log("JOB STATUS:",job.status);

      if(job.status==="done"){

         clearInterval(timer);

         console.log("OUTPUT:",job.output);

      }

   },3000);

}

   </script>
</body>
</html>
