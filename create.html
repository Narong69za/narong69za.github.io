<!DOCTYPE html>
<html lang="th">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>SN DESIGN CREATE</title>

<style>
body{
 background:#0b0b0b;
 color:white;
 font-family:Arial;
 margin:0;
}
.container{
 padding:20px;
}
button{
 background:#ff0033;
 color:white;
 border:none;
 padding:12px 20px;
 cursor:pointer;
}
</style>

</head>
<body>

<div class="container" id="app">

<h2 id="templateTitle"></h2>

<input id="promptInput" placeholder="Enter Prompt">

<br><br>

<button id="createBtn">CREATE</button>

<p id="statusText"></p>

</div>

<script>

const API_URL = "https://api.sn-designstudio.dev";

document.addEventListener("DOMContentLoaded", ()=>{

 console.log("CREATE READY");

 const params = new URLSearchParams(window.location.search);
 const templateID = params.get("template");

 if(!templateID){
   document.body.innerHTML="TEMPLATE NOT FOUND";
   return;
 }

 document.getElementById("templateTitle").innerText =
   "Template: "+templateID;

 document.getElementById("createBtn")
   .addEventListener("click", ()=>startRender(templateID));

});

async function startRender(templateID){

 console.log("CTA CLICKED");

 const prompt =
   document.getElementById("promptInput").value;

 if(!prompt){
   alert("Enter prompt");
   return;
 }

 document.getElementById("statusText").innerText="Starting...";

 try{

   const res = await fetch(API_URL+"/api/render",{

     method:"POST",
     headers:{ "Content-Type":"application/json" },
     body:JSON.stringify({
       templateID:templateID,
       prompt:prompt
     })

   });

   const data = await res.json();

   console.log("JOB CREATED:",data);

   document.getElementById("statusText")
     .innerText="Job Started";

 }catch(err){

   console.error(err);

   document.getElementById("statusText")
     .innerText="ENGINE ERROR";

 }

}

</script>

</body>
</html>
