<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>ULTRA GOD CREATE</title>

<style>

body{
background:#000;
color:#fff;
font-family:sans-serif;
padding:20px;
}

input{
width:100%;
padding:15px;
font-size:18px;
margin-top:10px;
}

button{
background:#ff0033;
color:white;
border:none;
padding:15px;
margin-top:15px;
font-size:18px;
}

#debug{
margin-top:20px;
background:#111;
padding:15px;
white-space:pre-wrap;
}

</style>

</head>

<body>

<h1 id="title">ULTRA GOD CREATE</h1>

<input id="prompt" placeholder="Prompt">

<button id="createBtn">CREATE VIDEO</button>

<h3 id="status">STATUS: IDLE</h3>

<div id="debug"></div>

<script>

const API_URL="https://api.sn-designstudio.dev";

const debugBox=document.getElementById("debug");

function debug(txt){
debugBox.innerText+=txt+"\n";
}

debug("DOM LOADED");


/* ================= TEMPLATE AUTO DETECT ================= */

const params=new URLSearchParams(window.location.search);
const template=params.get("template");

if(!template){

debug("NO TEMPLATE PARAM");
document.getElementById("status").innerText="ERROR: no template";

}else{

debug("Template detected: "+template);
document.getElementById("title").innerText="ENGINE : "+template;

}


/* ================= CREATE EVENT ================= */

document.getElementById("createBtn").onclick=async ()=>{

debug("CTA CLICKED");

const prompt=document.getElementById("prompt").value;

if(!prompt){

debug("NO PROMPT");
return;

}

document.getElementById("status").innerText="STATUS: SENDING";


try{

debug("Sending POST...");

const res=await fetch(API_URL+"/api/render",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
engine:template,
prompt:prompt
})

});

const data=await res.json();

debug("Response:"+JSON.stringify(data));

if(!data.jobID){

debug("NO JOBID");
return;

}

document.getElementById("status").innerText="STATUS: PROCESSING";

checkStatus(data.jobID);

}catch(e){

debug("ERROR:"+e);

}

};


/* ================= STATUS LOOP ================= */

async function checkStatus(id){

debug("START STATUS LOOP");

const timer=setInterval(async ()=>{

try{

const res=await fetch(API_URL+"/api/status/"+id);

const status=await res.json();

debug("STATUS:"+JSON.stringify(status));

if(status.status==="complete"){

clearInterval(timer);

document.getElementById("status").innerText="STATUS: COMPLETE";

}

if(status.status==="error"){

clearInterval(timer);

document.getElementById("status").innerText="STATUS: ERROR";

}

}catch(e){

debug("STATUS FAIL");

}

},2000);

}

</script>

</body>
</html>
