<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<title>Create | SN Design Studio</title>

<link rel="stylesheet" href="https://api.sn-designstudio.dev/assets/css/master.css">
<link rel="stylesheet" href="https://api.sn-designstudio.dev/assets/css/create.css">

</head>
<body>

<div class="create-wrapper">

<h1 class="create-title">ULTRA GOD CREATE</h1>

<h3 id="engineLabel"></h3>

<input id="prompt" placeholder="Enter prompt">

<button id="createBtn">CREATE VIDEO</button>

<h3 id="status">STATUS: IDLE</h3>

<div id="preview"></div>

</div>

<script>

const API="https://api.sn-designstudio.dev";

const params=new URLSearchParams(location.search);
const templateID=params.get("template");

document.getElementById("engineLabel").innerText=
"ENGINE: "+templateID;

document.getElementById("createBtn").onclick=async()=>{

const prompt=document.getElementById("prompt").value;

const res=await fetch(API+"/api/render",{
method:"POST",
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
templateID:templateID,
input:{prompt:prompt}
})
});

const data=await res.json();

startPolling(data.jobID);

};

function startPolling(id){

const loop=setInterval(async()=>{

const res=await fetch(API+"/api/status/"+id);
const data=await res.json();

if(data.status==="complete"){

clearInterval(loop);

document.getElementById("preview").innerHTML=
'<video controls autoplay src="'+data.url+'"></video>';

}

},3000);

}

</script>

</body>
</html>
