<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Official Website — SN DESIGN STUDIO</title>

<link rel="stylesheet" href="assets/css/create.css">

</head>

<body>

<header class="topbar">
SN DESIGN — CREATE ENGINE
</header>

<!-- HERO -->

<section class="hero-block">

<div class="hero-left">
<img id="templatePreview">
</div>

<div class="hero-right">

<h1 id="modelTitle">AI ENGINE</h1>

<div class="detail-box" id="detailBox"></div>

</div>

</section>

<!-- MAIN -->

<section class="create-container">

<div class="panel left">

<h3>PROJECT</h3>

<textarea id="promptInput"></textarea>

<input type="file" id="videoInput" accept="video/*">
<input type="file" id="imageInput" accept="image/*">

<button id="createBtn" class="cta-btn">
CREATE VIDEO
</button>

</div>

<div class="panel right">

<h3>STATUS</h3>

<div id="statusText">READY</div>

<div class="progress">
<div id="progressFill"></div>
</div>

</div>

</section>

<script>

document.addEventListener("DOMContentLoaded", function(){

/* =====================================
PRESET MAP (FINAL LOCK)
===================================== */

const presetMap = {

"dark-viral":{
provider:"replicate",
model:"black-forest-labs/flux-2-pro",
maxLength:30,
credit:3.5,
about:"Dark cinematic viral generation preset"
},

"cinematic-pro":{
provider:"runway",
model:"gen3",
maxLength:30,
credit:4.0,
about:"Professional cinematic video generator"
},

"face-swap":{
provider:"replicate",
model:"face-swap-ai",
maxLength:20,
credit:5.0,
about:"Face swap transformation"
},

"dance-motion":{
provider:"runway",
model:"motion-control",
maxLength:30,
credit:6.0,
about:"Motion control & dance animation"
},

"hyper-real":{
provider:"replicate",
model:"hyper-real-gen",
maxLength:15,
credit:3.0,
about:"Ultra realistic generation"
},

"ai-lipsync":{
provider:"replicate",
model:"ai-lipsync-model",
maxLength:20,
credit:4.0,
about:"AI LipSync video generation"
}

};


/* =====================================
LOAD TEMPLATE PARAM
===================================== */

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

if(!template){

document.body.innerHTML = `
<div style="color:white;padding:40px">
TEMPLATE PARAMETER MISSING
</div>`;
return;

}

const preset = presetMap[template];

if(!preset){

document.body.innerHTML = `
<div style="color:white;padding:40px">
INVALID TEMPLATE
</div>`;
return;

}


/* =====================================
UI LOAD
===================================== */

const preview = document.getElementById("templatePreview");
const title = document.getElementById("modelTitle");
const detailBox = document.getElementById("detailBox");

title.innerText = template.toUpperCase();

preview.src = "assets/images/template-"+template+".jpg";

detailBox.innerHTML = `
<p>${preset.about}</p>
<p>Provider : ${preset.provider}</p>
<p>Model : ${preset.model}</p>
<p>MAX LENGTH : ${preset.maxLength} sec</p>
<p>Credit cost : ${preset.credit}</p>
`;


/* =====================================
ENGINE CREATE
===================================== */

let jobID=null;

const statusText = document.getElementById("statusText");
const progressFill = document.getElementById("progressFill");

document.getElementById("createBtn").onclick = async function(){

statusText.innerText="Sending request...";

try{

const res = await fetch("/api/render",{

method:"POST",
headers:{"Content-Type":"application/json"},

body:JSON.stringify({

templateID:template,
provider:preset.provider,
model:preset.model,
duration:preset.maxLength,
prompt:document.getElementById("promptInput").value

})

});

const data = await res.json();

jobID = data.jobID;

watchStatus();

}catch(e){

statusText.innerText="ERROR";

}

};


/* =====================================
STATUS WATCH
===================================== */

function watchStatus(){

const interval=setInterval(async()=>{

try{

const res = await fetch("/api/status/"+jobID);
const d = await res.json();

statusText.innerText=d.status+" "+(d.progress||0)+"%";

progressFill.style.width=(d.progress||0)+"%";

if(d.status==="complete"){

clearInterval(interval);

statusText.innerText="RENDER COMPLETE";

}

}catch(e){}

},1500);

}

});

</script>

</body>
</html>
