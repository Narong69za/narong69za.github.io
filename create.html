<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Official Website — SN DESIGN STUDIO</title>

<link rel="stylesheet" href="assets/css/master.css">

</head>

<body class="create-page">

<div id="nav"></div>

<section class="hero-master">

<h1 id="engineTitle">AI ENGINE</h1>
<img id="heroImage" style="max-width:600px">

</section>

<section class="create-area">

<input type="file" id="videoInput" accept="video/*">
<video id="videoPreview" controls></video>

<input type="file" id="imageInput" accept="image/*">
<img id="imagePreview">

<button id="createBtn">CREATE VIDEO</button>

<div id="progress"></div>

</section>

<footer>
© SN Design Studio, 2026 · All rights reserved.
</footer>

<script src="assets/js/nav.js"></script>

<script>

/* ======================================
SN DESIGN CREATE ENGINE — ULTRA FINAL
====================================== */

window.addEventListener("load",()=>{

console.log("ULTRA ENGINE ACTIVE");

const progressDiv = document.getElementById("progress");
const btn = document.getElementById("createBtn");

const videoInput=document.getElementById("videoInput");
const imageInput=document.getElementById("imageInput");
const videoPreview=document.getElementById("videoPreview");
const imagePreview=document.getElementById("imagePreview");

/* ======================
TEMPLATE LOAD
====================== */

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

const hero = document.getElementById("heroImage");
const title = document.getElementById("engineTitle");

if(template && hero && title){

title.innerText = template.replaceAll("-"," ").toUpperCase();
hero.src = `assets/images/template-${template}.jpg`;

}

/* ======================
PREVIEW SYSTEM
====================== */

if(videoInput){
videoInput.addEventListener("change",(e)=>{
const file=e.target.files[0];
if(file){
videoPreview.src=URL.createObjectURL(file);
}
});
}

if(imageInput){
imageInput.addEventListener("change",(e)=>{
const file=e.target.files[0];
if(file){
imagePreview.src=URL.createObjectURL(file);
}
});
}

/* ======================
CREATE BUTTON (REAL ENGINE)
====================== */

if(btn){

btn.addEventListener("click", async()=>{

progressDiv.innerText="Starting render...";

try{

const res = await fetch("https://sn-design-api.onrender.com/api/render",{
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify({ mode:"direct" })
});

if(!res.ok) throw new Error("render failed");

const data = await res.json();

/* ⭐ IMPORTANT */
window.jobID = data.jobID;

progressDiv.innerText="Render started";

}catch(err){

progressDiv.innerText="Render error";

}

});

}

/* ======================
REAL STATUS SYNC ENGINE
====================== */

let lastStatus="";

async function ultraSync(){

if(!window.jobID) return;

try{

const res = await fetch("https://sn-design-api.onrender.com/api/status?id="+window.jobID);

if(!res.ok) return;

const data = await res.json();

const newStatus = data.status+"-"+data.progress;

if(newStatus !== lastStatus){

lastStatus=newStatus;

progressDiv.innerText =
"ENGINE STATUS : "+data.status.toUpperCase()+" | "+data.progress+"%";

}

if(data.status==="complete"){

progressDiv.innerText="✅ RENDER COMPLETE";

}

}catch(e){

console.log("ULTRA SYNC FAIL");

}

}

setInterval(ultraSync,1000);

});

</script>

</body>
</html>
