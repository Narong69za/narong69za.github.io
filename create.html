<!DOCTYPE html>
<html lang="en">
<head>

<title>Official Website — SN DESIGN STUDIO</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link rel="stylesheet" href="assets/css/master.css">

<style>

/* ======================================================
ULTRA BLOCK UI (ADD ONLY)
====================================================== */

.ultra-block{

position:fixed;
top:50%;
left:50%;
transform:translate(-50%,-50%);
background:#0b0b0b;
border:1px solid rgba(255,0,80,0.4);
padding:30px;
border-radius:14px;
z-index:9999;
color:#fff;
text-align:center;
box-shadow:0 0 40px rgba(255,0,80,0.4);

}

</style>

</head>

<body class="create-page">

<div id="nav"></div>

<section class="hero-master">

<h1 id="engineTitle">AI ENGINE</h1>
<img id="heroImage" style="max-width:600px">

</section>

<section class="create-area">

<input type="file" id="videoInput" accept="video/*">
<video id="videoPreview" controls></video>

<input type="file" id="imageInput" accept="image/*">
<img id="imagePreview">

<button id="createBtn">CREATE VIDEO</button>

</section>

<footer>
© SN Design Studio, 2026 · All rights reserved.
</footer>

<script src="assets/js/nav.js"></script>

<script>

/* ======================================================
ULTRA FINAL PLATFORM CORE
====================================================== */

const USER = {

   dev:true,          // DEV MODE
   freeDaily:3,
   usedToday:0,
   points:11000

};


// ==============================
// TEMPLATE LOAD
// ==============================

const params = new URLSearchParams(window.location.search);
const template = params.get("template");

const hero = document.getElementById("heroImage");
const title = document.getElementById("engineTitle");

if(template && hero && title){

   title.innerText = template.replaceAll("-"," ").toUpperCase();
   hero.src = `assets/images/template-${template}.jpg`;

}


// ==============================
// PREVIEW FILE
// ==============================

let videoFile=null;
let imageFile=null;

document.getElementById("videoInput").addEventListener("change",(e)=>{

   videoFile=e.target.files[0];

   if(videoFile){

      const vid=document.getElementById("videoPreview");
      vid.src=URL.createObjectURL(videoFile);

      vid.onloadedmetadata=function(){

         if(vid.duration > 30){

            showBlock("Video limit 30 seconds");

            videoFile=null;
            vid.src="";

         }

      };

   }

});

document.getElementById("imageInput").addEventListener("change",(e)=>{

   imageFile=e.target.files[0];

   if(imageFile){
      document.getElementById("imagePreview").src=
      URL.createObjectURL(imageFile);
   }

});


// ==============================
// UI BLOCK
// ==============================

function showBlock(msg){

   const box=document.createElement("div");

   box.className="ultra-block";

   box.innerHTML=`<h3>${msg}</h3>`;

   document.body.appendChild(box);

}


// ==============================
// CREDIT CHECK
// ==============================

function allowRender(){

   if(USER.dev===true) return true;

   if(USER.usedToday < USER.freeDaily){

      USER.usedToday++;
      return true;

   }

   if(USER.points >= 100){

      USER.points -= 100;
      return true;

   }

   showBlock("Not enough credits");

   return false;

}


// ==============================
// AUTO RESULT WATCH
// ==============================

async function watchJob(id){

   const timer=setInterval(async()=>{

      const res=await fetch("/api/job/"+id);
      const data=await res.json();

      if(data.status==="done"){

         clearInterval(timer);

         alert("Render completed");

      }

   },3000);

}


// ==============================
// CREATE BUTTON
// ==============================

document.getElementById("createBtn").addEventListener("click", async ()=>{

   if(!template){

      showBlock("Template missing");
      return;

   }

   if(!allowRender()) return;

   const res=await fetch("/api/render",{

      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({

         template:template,
         video: videoFile ? videoFile.name:null,
         image: imageFile ? imageFile.name:null

      })

   });

   const data=await res.json();

   if(data.jobId){

      watchJob(data.jobId);

   }

});

</script>

<!-- ====================================================== -->
<!-- SN DESIGN ADD ONLY : AUTO TEMPLATE MODEL SYSTEM -->
<!-- ====================================================== -->

<script>

document.querySelectorAll("[data-template]").forEach(el=>{
   el.addEventListener("click",()=>{
      const model = el.dataset.template;
      if(model){
         window.location.href = "create.html?template="+model;
      }
   });
});

</script>

</body>
</html>
