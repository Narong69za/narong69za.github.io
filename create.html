<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<title>ULTRA AUTO CREATE</title>

<link rel="stylesheet" href="https://api.sn-designstudio.dev/assets/css/master.css">
<link rel="stylesheet" href="https://api.sn-designstudio.dev/assets/css/create.css">

</head>
<body style="background:#000;color:#0f0;font-family:monospace">

<h2>ULTRA TRACE MODE</h2>

<div id="traceLog"></div>
<hr>
<div id="presetContainer"></div>

<script>

const API="https://sn-design-api.onrender.com";

function log(msg){
   const div=document.getElementById("traceLog");
   div.innerHTML += "<div>"+msg+"</div>";
}

log("STEP 1: SCRIPT LOADED");

async function loadAllPresets(){

   log("STEP 2: loadAllPresets CALLED");

   try{

      log("STEP 3: FETCH START");

      const res = await fetch(API+"/api/templates");

      log("STEP 4: STATUS "+res.status);

      if(!res.ok){
         log("FAIL: API NOT OK");
         return;
      }

      const data = await res.json();

      log("STEP 5: DATA RECEIVED");

      renderPresets(data);

   }catch(e){

      log("ERROR: "+e.message);

   }

}

function renderPresets(list){

   log("STEP 6: renderPresets");

   const container=document.getElementById("presetContainer");

   if(!container){
      log("FAIL: presetContainer NOT FOUND");
      return;
   }

   Object.values(list).forEach(preset=>{

      log("CARD: "+preset.id);

      const card=document.createElement("div");

      card.style.border="1px solid #0f0";
      card.style.margin="10px";
      card.style.padding="10px";

      card.innerHTML=`
         <h3>${preset.name || preset.id}</h3>
         <button onclick="openCreate('${preset.id}')">OPEN</button>
      `;

      container.appendChild(card);

   });

}

function openCreate(slug){
   location.href="/create.html?template="+slug;
}

loadAllPresets();

</script>

</body>
</html>
