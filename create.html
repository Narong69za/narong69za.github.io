<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>ULTRA ENGINE CONTROL</title>

<link rel="stylesheet" href="/assets/css/create-premium.css">

</head>

<body>

<div class="container">

<h1>ULTRA ENGINE CONTROL</h1>

<input id="prompt" placeholder="Enter prompt">

<div class="actionRow">

<button data-type="video">Generate Video</button>
<button data-type="image">Generate Image</button>
<button data-type="upscale">Upscale</button>

</div>


<div class="engineGrid">

<div class="engineColumn red">

<h2>RED ENGINE</h2>

<button data-engine="replicate" data-alias="dark-viral">Dark Viral</button>
<button data-engine="replicate" data-alias="ai-lipsync">AI LipSync</button>
<button data-engine="replicate" data-alias="dance-motion">Dance Motion</button>
<button data-engine="replicate" data-alias="face-swap">Face Swap</button>

</div>


<div class="engineColumn blue">

<h2>BLUE ENGINE</h2>

<button data-engine="runway" data-alias="dark-viral">Dark Viral</button>
<button data-engine="runway" data-alias="ai-lipsync">AI LipSync</button>
<button data-engine="runway" data-alias="dance-motion">Dance Motion</button>
<button data-engine="runway" data-alias="face-swap">Face Swap</button>

</div>

</div>


<div id="dynamicInputs"></div>

<button id="generateBtn">GENERATE</button>

<div id="status">STATUS: IDLE</div>

</div>


<script>

/* =========================
ULTRA AUTO ENGINE PIPELINE
ADD ONLY PATCH
========================= */

const API_BASE="https://sn-design-api.onrender.com";

/* ENGINE INPUT SCHEMA */

const ENGINE_SCHEMA={

"dance-motion":["template","subject"],
"face-swap":["source","target"],
"dark-viral":["image"],
"ai-lipsync":["video","voice"]

};

let selectedEngine=null;
let selectedAlias=null;
let selectedType=null;


/* ACTION TYPE */

document.querySelectorAll("[data-type]").forEach(btn=>{

btn.onclick=()=>{

selectedType=btn.dataset.type;
console.log("TYPE SELECTED:",selectedType);

};

});


/* ENGINE SELECT */

document.querySelectorAll("[data-engine]").forEach(btn=>{

btn.onclick=()=>{

selectedEngine=btn.dataset.engine;
selectedAlias=btn.dataset.alias;

console.log("ENGINE:",selectedEngine,"ALIAS:",selectedAlias);

renderInputs(selectedAlias);

};

});


/* DYNAMIC INPUT RENDER */

function renderInputs(alias){

const box=document.getElementById("dynamicInputs");

box.innerHTML="";

if(!ENGINE_SCHEMA[alias]) return;

ENGINE_SCHEMA[alias].forEach(name=>{

const wrap=document.createElement("div");

const label=document.createElement("div");
label.innerText="UPLOAD "+name;

const input=document.createElement("input");

input.type="file";
input.name=name;
input.required=true;

wrap.appendChild(label);
wrap.appendChild(input);

box.appendChild(wrap);

});

}


/* =========================
ULTRA GENERATE HANDLER
========================= */

document.getElementById("generateBtn").onclick=async()=>{

try{

if(!selectedEngine||!selectedAlias){

alert("select engine");

return;

}

const form=new FormData();

form.append("engine",selectedEngine);
form.append("alias",selectedAlias);
form.append("type",selectedType||"video");

form.append("prompt",document.getElementById("prompt").value||"");


/* CHECK FILE INPUT */

let missing=false;

document.querySelectorAll("#dynamicInputs input").forEach(input=>{

if(!input.files[0]){

missing=true;

}else{

form.append(input.name,input.files[0]);

}

});

if(missing){

alert("missing file input");

return;

}

document.getElementById("status").innerText="STATUS: QUEUED";

console.log("POST TO:",API_BASE+"/api/render");

/* SEND TO BACKEND */

const res=await fetch(API_BASE+"/api/render",{

method:"POST",
body:form

});

console.log("HTTP STATUS:",res.status);

if(!res.ok){

const text=await res.text();
document.getElementById("status").innerText="STATUS: ERROR "+res.status;
console.error("SERVER ERROR:",text);
return;

}

const json=await res.json();

console.log("RESPONSE:",json);

document.getElementById("status").innerText="STATUS: "+json.status;

}catch(err){

console.error("CLIENT ERROR:",err);

document.getElementById("status").innerText="STATUS: CLIENT ERROR";

}

};

</script>

</body>
</html>
