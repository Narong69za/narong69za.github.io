<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>SN DESIGN LOGIN</title>

  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <style>
    body{
      background:#000;
      color:#fff;
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
      font-family:sans-serif;
    }

    .login-box{
      text-align:center;
    }
  </style>
</head>

<body>

  <div class="login-box">
    <h1>SN DESIGN LOGIN</h1>

    <div id="g_id_onload"
         data-client_id="322233270752-6itdqaskdsdbc7lu2t3fchm792slct4n.apps.googleusercontent.com"
         data-callback="handleCredentialResponse">
    </div>

    <div class="g_id_signin"></div>
  </div>

  <script>
    const API = "https://sn-design-api.onrender.com";

    async function handleCredentialResponse(response){
        try {

            const res = await fetch(`${API}/api/auth/google`, {   // ✅ แก้ตรงนี้
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    token: response.credential
                })
            });

            const data = await res.json();

            if(!res.ok){
                alert("Login failed");
                return;
            }

            localStorage.setItem("token", data.token);

            // ไปหน้า create หรือ templates ตามที่คุณใช้จริง
            window.location.href="/create.html";

        } catch(err){
            console.error(err);
            alert("Server error");
        }
    }
  </script>

</body>
</html>
